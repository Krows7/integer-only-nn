Cleaning build files...
Creating directory obj...
Creating directory build...
Compiling (API) src/api/linear.c -> obj/linear.o...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra -c src/api/linear.c -o obj/linear.o
Compiling (API) src/api/network.c -> obj/network.o...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra -c src/api/network.c -o obj/network.o
Compiling (API) src/api/quantization.c -> obj/quantization.o...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra -c src/api/quantization.c -o obj/quantization.o
Compiling (EXT) src/ext/dataset_bench.c -> obj/dataset_bench.o...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra -c src/ext/dataset_bench.c -o obj/dataset_bench.o
Compiling (EXT) src/ext/float_ops.c -> obj/float_ops.o...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra -c src/ext/float_ops.c -o obj/float_ops.o
Compiling (EXT) src/ext/weights.c -> obj/weights.o...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra -c src/ext/weights.c -o obj/weights.o
Linking build/digits-new...
gcc -Wall -O3 -Isrc/api -Isrc/ext -g -Wextra src/tests/digits-new.c obj/linear.o obj/network.o obj/quantization.o obj/dataset_bench.o obj/float_ops.o obj/weights.o -lm -o build/digits-new
rm obj/linear.o obj/network.o obj/weights.o obj/quantization.o obj/dataset_bench.o obj/float_ops.o
==90698== Memcheck, a memory error detector
==90698== Copyright (C) 2002-2022, and GNU GPL'd, by Julian Seward et al.
==90698== Using Valgrind-3.22.0 and LibVEX; rerun with -h for copyright info
==90698== Command: ./build/digits-new
==90698==
--- C Implementation Configuration ---
Using learning rate parameter mu = 4
Batch Size: 64
Target BITWIDTH = 7
Hidden Neurons: 128
Epochs: 10
-------------------------------------
Initializing Optical Digit Recognition Test (C)...
Allocating memory for labels...
Loading training data (float) from /home/huy/digits/optdigits.tra...
Loaded 3823 valid float samples from /home/huy/digits/optdigits.tra.
Loading testing data (float) from /home/huy/digits/optdigits.tes...
Loaded 1797 valid float samples from /home/huy/digits/optdigits.tes.
Initializing network...
Network:
Batch Size: 64
Input (64) -> Linear (128) -> ReLU -> Linear (10)

--- Starting Training (C) for 10 Epochs ---

Epoch 1/10
  Epoch 1: Processed 3823 / 3823 samples
Epoch 1 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 91.71% (1648 / 1797 correct)

Epoch 2/10
  Epoch 2: Processed 3823 / 3823 samples
Epoch 2 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 92.77% (1667 / 1797 correct)

Epoch 3/10
  Epoch 3: Processed 3823 / 3823 samples
Epoch 3 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 93.38% (1678 / 1797 correct)

Epoch 4/10
  Epoch 4: Processed 3823 / 3823 samples
Epoch 4 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 93.60% (1682 / 1797 correct)

Epoch 5/10
  Epoch 5: Processed 3823 / 3823 samples
Epoch 5 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 93.88% (1687 / 1797 correct)

Epoch 6/10
  Epoch 6: Processed 3823 / 3823 samples
Epoch 6 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 94.71% (1702 / 1797 correct)

Epoch 7/10
  Epoch 7: Processed 3823 / 3823 samples
Epoch 7 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 94.32% (1695 / 1797 correct)

Epoch 8/10
  Epoch 8: Processed 3823 / 3823 samples
Epoch 8 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 93.16% (1674 / 1797 correct)

Epoch 9/10
  Epoch 9: Processed 3823 / 3823 samples
Epoch 9 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 93.71% (1684 / 1797 correct)

Epoch 10/10
  Epoch 10: Processed 3823 / 3823 samples
Epoch 10 finished. Processed 3823 samples.

--- Evaluating Network (C) ---
Evaluation Complete.
Accuracy on test set: 94.94% (1706 / 1797 correct)

--- Training Finished (C) ---

Cleaning up resources...
Freeing network...
Freeing training features...
Freeing testing features...
Freeing labels...
Optical Digit Recognition Test Finished (C).
==90698==
==90698== HEAP SUMMARY:
==90698==     in use at exit: 0 bytes in 0 blocks
==90698==   total heap usage: 957,429 allocs, 957,429 frees, 153,442,765 bytes allocated
==90698==
==90698== All heap blocks were freed -- no leaks are possible
==90698==
==90698== For lists of detected and suppressed errors, rerun with: -s
==90698== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)